<!DOCTYPE html>
<!-- saved from url=(0050)https://www.cnblogs.com/springsnow/p/13088186.html -->
<html lang="zh-cn" style="--olcb-folder-code-block-max-height:80vh;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="never">
    <meta name="description" content="一、介绍： Selenium 是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。 1、Selenium Webdriver（也就是Selenium2">
    <meta property="og:description" content="一、介绍： Selenium 是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。 1、Selenium Webdriver（也就是Selenium2">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>C#爬虫（03）：使用Selenium - springsnow - 博客园</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.svg" type="image/svg+xml">
    
    <style>#home :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([class*="language-"]):not([highlighted]):not(.hljs):not([class*="brush:"]), :not(.cnblogs_code):not(.cnblogs_Highlighter)>pre:not([class*="language-"]):not([highlighted]):not(.hljs):not([class*="brush:"]) {background: rgb(30, 30, 30);
        padding: 13px;
        border: 0px none rgb(212, 212, 212);
        border-radius: 0px;
        border-color: transparent;
        color: rgb(212, 212, 212);
        font-family: Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace;
        font-size: 13px</style><link rel="stylesheet" href="./03_files/blog-common.min.css">
    

    <link id="MainCss" rel="stylesheet" href="./03_files/bundle-anothereon001.min.css">
        <link id="highlighter-theme-prism-vsc-dark-plus" type="text/css" rel="stylesheet" href="./03_files/prism-vsc-dark-plus.css">
    <link type="text/css" rel="stylesheet" href="./03_files/custom.css">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./03_files/bundle-anothereon001-mobile.min.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/springsnow/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/springsnow/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/springsnow/wlwmanifest.xml">
    <script type="text/javascript" async="" src="./03_files/analytics.js.下載"></script><script type="text/javascript" src="./03_files/encoder.js.下載"></script><script>
        var currentBlogId = 27803;
        var currentBlogApp = 'springsnow';
        var isLogined = false;
        var isBlogOwner = false;
        var skinName = 'AnotherEon001';
        var visitorUserId = '';
        var hasCustomScript = true;
        try {
            if (hasCustomScript && document.referrer && document.referrer.indexOf('baidu.com') >= 0) {
                Object.defineProperty(document, 'referrer', { value: '' });
                Object.defineProperty(Document.prototype, 'referrer', { get: function(){ return ''; } });
            }
        } catch(error) { }
        window.cb_enable_mathjax = false;
        window.mathEngine = 0;
        window.codeHighlightEngine = 2;
        window.enableCodeLineNumber = true;
        window.codeHighlightTheme = 'prism-vsc-dark-plus';
        window.darkModeCodeHighlightTheme = 'prism-vsc-dark-plus';
        window.isDarkCodeHighlightTheme = true;
        window.isDarkModeCodeHighlightThemeDark = true;
        window.isDisableCodeHighlighter = false;
        window.enableCodeThemeTypeFollowSystem = false;
    </script>
        <script>
            var currentPostDateAdded = '2020-06-10 19:44';
        </script>
    <script src="./03_files/jquery-2.2.0.min.js.下載"></script>
    <script src="./03_files/blog-common.min.js.下載"></script><style>.medium-zoom-overlay {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  opacity: 0;
  transition: opacity 300ms;
  will-change: opacity;
}

.medium-zoom--opened .medium-zoom-overlay {
  cursor: pointer;
  cursor: zoom-out;
  opacity: 1;
}

.medium-zoom-image {
  cursor: pointer;
  cursor: zoom-in;
  /*
    The `transition` is marked as "!important" for the animation to happen
    even though it's overriden by another inline `transition` style attribute.

    This is problematic with frameworks that generate inline styles on their
    images (e.g. Gatsby).

    See https://github.com/francoischalifour/medium-zoom/issues/110
   */
  transition: transform 300ms cubic-bezier(0.2, 0, 0.2, 1) !important;
}

.medium-zoom-image--hidden {
  visibility: hidden;
}

.medium-zoom-image--opened {
  position: relative;
  cursor: pointer;
  cursor: zoom-out;
  will-change: transform;
}
</style><script id="prismjs-script" src="./03_files/prism.js.下載" type="text/javascript" async=""></script><link id="prism-line-numbers-style" href="./03_files/prism-line-numbers.css" rel="stylesheet" type="text/css">
    

    
<script id="prismjs-autoloader-script" src="./03_files/prism-autoloader.min.js.下載" type="text/javascript" async=""></script><script id="prism-line-numbers-script" src="./03_files/prism-line-numbers.min.js.下載" type="text/javascript" async=""></script><meta http-equiv="origin-trial" content="A+cA2PUOfIOKAdSDJOW5CP9ZlxONy1yu+hqAq72zUtKw4rLdihqRp6Nui/jUyCyegr+BUtH+C+Elv0ufn05yBQEAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A+zsdH3aNZT/bkjT8U/o5ACzyaeNYzTvtoVmwf/KOilfv39pxY2AIsOwhQJv+YnXp98i3TqrQibIVtMWs5UHjgoAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="AxceVEhIegcDEHqLXFQ2+vPKqzCppoJYsRCZ/BdfVnbM/sUUF2BXV8lwNosyYjvoxnTh2FC8cOlAnA5uULr/zAUAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="./03_files/pubads_impl_2022100402.js.下載" async=""></script><link rel="preload" href="./03_files/f.txt" as="script"><script type="text/javascript" src="./03_files/f.txt"></script><link rel="preload" href="./03_files/f(1).txt" as="script"><script type="text/javascript" src="./03_files/f(1).txt"></script></head>
<body class="skin-anothereon001 no-navbar">
<a name="top"></a>
<div id="top_nav" class="navbar forpc navbar-custom">
    <nav id="nav_main" class="navbar-main">
        <ul id="nav_left" class="navbar-list navbar-left">
            <li class="navbar-branding">
                <a href="https://www.cnblogs.com/" title="开发者的网上家园" role="banner">
                    <img src="./03_files/logo.svg" alt="博客园Logo">
                </a>
            </li>
            <li>
                <a href="https://www.cnblogs.com/" onclick="countClicks(&#39;skin-navbar-sitehome&#39;)">首页</a>
            </li>
            <li>
                <a href="https://news.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-news&#39;)">新闻</a>
            </li>
            <li>
                <a href="https://q.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-q&#39;)">博问</a>
            </li>
            <li>
                <a id="nav_brandzone" href="https://brands.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-brands&#39;)">专区</a>
            </li>
            <li>
                <a href="https://ing.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-ing&#39;)">闪存</a>
            </li>
            <li>
                <a href="https://edu.cnblogs.com/" onclick="countClicks(&#39;nav&#39;, &#39;skin-navbar-edu&#39;)">班级</a>
            </li>
        </ul>
        <ul id="nav_right" class="navbar-list navbar-right">
            <li>
                <form id="zzk_search" class="navbar-search" action="https://zzk.cnblogs.com/s" method="get" role="search">
                    <input name="w" id="zzk_search_input" placeholder="代码改变世界" type="search" tabindex="3">
                    <button type="submit" id="zzk_search_button">
                        <img src="./03_files/search.svg" alt="搜索">
                    </button>
                </form>
            </li>
            <li id="navbar_login_status" class="navbar-list">
                <a class="navbar-user-info navbar-blog" href="https://i.cnblogs.com/EditPosts.aspx?opt=1" alt="写随笔" title="写随笔" style="display: none;">
                    <img id="new_post_icon" class="navbar-icon" src="./03_files/newpost.svg" alt="写随笔">
                </a>
                <a id="navblog-myblog-icon" class="navbar-user-info navbar-blog" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx" alt="我的博客" title="我的博客" style="display: none;">
                    <img id="myblog_icon" class="navbar-icon" src="./03_files/myblog.svg" alt="我的博客">
                </a>
                <a class="navbar-user-info navbar-message navbar-icon-wrapper" href="https://msg.cnblogs.com/" alt="短消息" title="短消息" style="display: none;">
                    <img id="msg_icon" class="navbar-icon" src="./03_files/message.svg" alt="短消息">
                    <span id="msg_count" style="display: none"></span>
                </a>
                <a id="navbar_lite_mode_indicator" data-current-page="blog" style="display: none" href="javascript:void(0)" alt="简洁模式" title="简洁模式启用，您在访问他人博客时会使用简洁款皮肤展示">
                    <img class="navbar-icon" src="./03_files/lite-mode-on.svg" alt="简洁模式">
                </a>
                <div id="user_info" class="navbar-user-info dropdown" style="display: none;">
                    <a class="dropdown-button" href="https://home.cnblogs.com/">
                        <img id="user_icon" class="navbar-avatar" src="./03_files/avatar-default.svg" alt="用户头像">
                    </a>
                    <div class="dropdown-menu">
                        <a id="navblog-myblog-text" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx">我的博客</a>
                        <a href="https://home.cnblogs.com/">我的园子</a>
                        <a href="https://account.cnblogs.com/settings/account">账号设置</a>
                        <a href="javascript:void(0)" id="navbar_lite_mode_toggle" title="简洁模式会使用简洁款皮肤显示所有博客">
    简洁模式 <img id="navbar_lite_mode_on" src="./03_files/lite-mode-check.svg" class="hide"><span id="navbar_lite_mode_spinner" class="hide">...</span>
</a>
                        <a href="javascript:void(0)" onclick="account.logout();">退出登录</a>
                    </div>
                </div>
                <a class="navbar-anonymous" href="https://account.cnblogs.com/signup" style="display: inline;">注册</a>
                <a class="navbar-anonymous" href="javascript:void(0);" onclick="account.login()" style="display: inline;">登录</a>
            </li>
        </ul>
    </nav>
</div>

<div id="page_begin_html">
<script type="text/javascript">
/*
    功能：生成博客目录的JS工具
    测试：IE8，火狐，google测试通过
    孤傲苍狼
    2014-5-11
*/
var BlogDirectory = {
    /*
        获取元素位置，距浏览器左边界的距离（left）和距浏览器上边界的距离（top）
    */
    getElementPosition:function (ele) {        
        var topPosition = 0;
        var leftPosition = 0;
        while (ele){              
            topPosition += ele.offsetTop;
            leftPosition += ele.offsetLeft;        
            ele = ele.offsetParent;     
        }  
        return {top:topPosition, left:leftPosition}; 
    },

    /*
    获取滚动条当前位置
    */
    getScrollBarPosition:function () {
        var scrollBarPosition = document.body.scrollTop || document.documentElement.scrollTop;
        return  scrollBarPosition;
    },
    
    /*
    移动滚动条，finalPos 为目的位置，internal 为移动速度
    */
    moveScrollBar:function(finalpos, interval) {

        //若不支持此方法，则退出
        if(!window.scrollTo) {
            return false;
        }

        //窗体滚动时，禁用鼠标滚轮
        window.onmousewheel = function(){
            return false;
        };
          
        //清除计时
        if (document.body.movement) { 
            clearTimeout(document.body.movement); 
        } 

        var currentpos =BlogDirectory.getScrollBarPosition();//获取滚动条当前位置

        var dist = 0; 
        if (currentpos == finalpos) {//到达预定位置，则解禁鼠标滚轮，并退出
            window.onmousewheel = function(){
                return true;
            }
            return true; 
        } 
        if (currentpos < finalpos) {//未到达，则计算下一步所要移动的距离
            dist = Math.ceil((finalpos - currentpos)/10); 
            currentpos += dist; 
        } 
        if (currentpos > finalpos) { 
            dist = Math.ceil((currentpos - finalpos)/10); 
            currentpos -= dist; 
        }
        
        var scrTop = BlogDirectory.getScrollBarPosition();//获取滚动条当前位置
        window.scrollTo(0, currentpos);//移动窗口
        if(BlogDirectory.getScrollBarPosition() == scrTop)//若已到底部，则解禁鼠标滚轮，并退出
        {
            window.onmousewheel = function(){
                return true;
            }
            return true;
        }
        
        //进行下一步移动
        var repeat = "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")"; 
        document.body.movement = setTimeout(repeat, interval); 
    },
    
    htmlDecode:function (text){
        var temp = document.createElement("div");
        temp.innerHTML = text;
        var output = temp.innerText || temp.textContent;
        temp = null;
        return output;
    },

    /*
    创建博客目录，
    id表示包含博文正文的 div 容器的 id，
    mt 和 st 分别表示主标题和次级标题的标签名称（如 H2、H3，大写或小写都可以！），
    interval 表示移动的速度
    */
    createBlogDirectory:function (id, mt, st, interval){
         //获取博文正文div容器
        var elem = document.getElementById(id);
        if(!elem) return false;
        //获取div中所有元素结点
        var nodes = elem.getElementsByTagName("*");
        //创建博客目录的div容器
        var divSideBar = document.createElement('DIV');
        divSideBar.className = 'uprightsideBar';
        divSideBar.setAttribute('id', 'uprightsideBar');
        var divSideBarTab = document.createElement('DIV');
        divSideBarTab.setAttribute('id', 'sideBarTab');
        divSideBar.appendChild(divSideBarTab);
        var h2 = document.createElement('H2');
        divSideBarTab.appendChild(h2);
        var txt = document.createTextNode('目录导航');
        h2.appendChild(txt);
        var divSideBarContents = document.createElement('DIV');
        divSideBarContents.style.display = 'none';
        divSideBarContents.setAttribute('id', 'sideBarContents');
        divSideBar.appendChild(divSideBarContents);
        //创建自定义列表
        var dlist = document.createElement("dl");
        divSideBarContents.appendChild(dlist);
        var num = 0;//统计找到的mt和st
        mt = mt.toUpperCase();//转化成大写
        st = st.toUpperCase();//转化成大写
        //遍历所有元素结点
        for(var i=0; i<nodes.length; i++)
        {
            if(nodes[i].nodeName == mt|| nodes[i].nodeName == st)    
            {
                //获取标题文本
                var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g,"");//innerHTML里面的内容可能有HTML标签，所以用正则表达式去除HTML的标签
                nodetext = nodetext.replace(/ /ig, "");//替换掉所有的 
                nodetext = BlogDirectory.htmlDecode(nodetext);
                //插入锚        
                nodes[i].setAttribute("id", "blogTitle" + num);
                var item;
                switch(nodes[i].nodeName)
                {
                    case mt:    //若为主标题 
                        item = document.createElement("dt");
                        break;
                    case st:    //若为子标题
                        item = document.createElement("dd");
                        break;
                }
                
                //创建锚链接
                var itemtext = document.createTextNode(nodetext);
                item.appendChild(itemtext);
                item.setAttribute("name", num);
                item.onclick = function(){        //添加鼠标点击触发函数
                    var pos = BlogDirectory.getElementPosition(document.getElementById("blogTitle" + this.getAttribute("name")));
                    if(!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
                };            
                
                //将自定义表项加入自定义列表中
                dlist.appendChild(item);
                num++;
            }
        }
        
        if(num == 0) return false; 
        /*鼠标进入时的事件处理*/
        divSideBarTab.onmouseenter = function(){
            divSideBarContents.style.display = 'block';
        }
        /*鼠标离开时的事件处理*/
        divSideBar.onmouseleave = function() {
            divSideBarContents.style.display = 'none';
        }

        document.body.appendChild(divSideBar);
    }
    
};
 


window.onload=function(){
    /*页面加载完成之后生成博客目录*/
    BlogDirectory.createBlogDirectory("cnblogs_post_body","h2","h3",20);
}

</script>

<link href="./03_files/default.css" rel="stylesheet">  


</div>

<div id="wrapper">
<div id="header">

<div id="top">
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/springsnow/">工作在浏览器上人-YangBobin</a>
</h1>
<div id="subtitle">知识不在广泛，在于精通。知识不在积累，在于消化。 学习不在激情，在于坚持。书不在多，一两本真正看懂就行。书读百遍，其义自现。</div>
</div>
<div id="sub"><div class="BlogStats">随笔 - 892, 文章 - 1, 评论 - 68, 阅读 - 
<span title="总阅读数: 1231088">
123万</span></div>

</div>




</div>
<div id="main_container">
<div id="main_content">
<div id="content">
	<div id="post_detail">
    <div class="post">
        <h2>
            
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/springsnow/p/13088186.html">
    <span role="heading" aria-level="2">C#爬虫（03）：使用Selenium</span>
    
</a><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button>

        </h2>
        <div class="postbody">
            <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html"><a rel="nofollow noopener" name="_labelTop" target="_blank"></a><div id="navCategory" style="color:#152e97;"><p style="font-size:18px;"><b>目录</b></p><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label0">一、介绍：</a><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label0_0">1、安装Selenium：</a></li></ul></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label1">二、等待</a><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label1_0">1、隐式等待：ImplicitlyWait</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label1_1">2、显示等待：WebDriverWait()</a></li></ul></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label2">三、查找（定位对象）</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3">四、获取页面元素和元素内容</a><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_0">1.Title：标题</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_1">2.Url：链接</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_2">3.Text：元素的文本值</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_3">4.Selected勾选情况、TagName标记名标、Enabled编辑状态、Displayed显示状态</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_4">5.GetAttribute（）获取标签的属性</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label3_5">6.弹出对话框的处理</a></li></ul></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4">五、操作元素对象WebElement</a><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_0">1、模拟鼠标点击元素</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_1">2、下拉列表框Select的操作</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_2">2、执行JS</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_3">3、页面导航 </a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_4">4、拖拽操作(可以实现滑动验证码的验证)</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_5">5、模拟鼠标晃动</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_6">6、截图功能</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label4_7">7、selenium操作滚轮滑动到底部</a></li></ul></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label5">六、获得窗口标识WindowHandles</a><ul><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label5_0">1、关闭多个子Browser窗口</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label5_1">2、对iframe中元素的定位</a></li></ul></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label6">七、Cookies</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label7">八、Window窗口控制</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label8">九、事件</a></li><li><a rel="nofollow noopener" href="https://www.cnblogs.com/springsnow/p/13088186.html#_label9">十、关闭浏览器</a></li></ul></div><p>&nbsp;</p><hr style="height:1px;border:none;border-top:1px dashed #0066CC;">
<div style="text-align: right;"><a rel="nofollow noopener" name="_label0" target="_blank"></a></div><h2 id="blogTitle0">一、介绍：<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>Selenium 是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。</p>
<p><strong>1、Selenium Webdriver</strong>（也就是<strong>Selenium2，Selenium3</strong>）和<strong>Selenium RC</strong>（<strong>Selenium 1</strong>）一样提供了<strong>web</strong>自动化的各种语言调用接口库。相比<strong>Selenium RC</strong>，<strong>Selenium WebDriver</strong>的编程接口更加直观易懂，也更加简练。</p>
<p>但是和<strong>Selenium RC</strong>不同的是，<strong>Selenium Webdriver</strong>是通过各种浏览器的驱动（<strong>web driver</strong>）来驱动浏览器的，而不是通过注入<strong>JavaScript</strong>的方式。</p>
<p>我们的代码运行起来是一个进程，里面调用<strong>Selenium WebDriver</strong>的库和各个浏览器的驱动进程 进行交互，传递<strong>Selenium</strong>命令 给它们，并且获取命令执行的结果，返回给我们的代码进行处理。</p>
<p><strong>2、Selenium WebDriver</strong>目前包括两个版本<strong>Selenium 2</strong>和<strong>Selenium 3</strong>。这两个版本从开发代码调用接口上来看，几乎没什么区别。区别在于库的实现和<strong>web driver</strong>的实现。</p>
<p><strong>S<strong>elenium2</strong>是<strong>Selenium</strong>组织帮各种浏览器写<strong>web driver</strong>的，而<strong>Selenium 3</strong>里面的<strong>web driver</strong>是由各个浏览器厂商（<strong>Apple,Google,Microsoft,Mozilla</strong>）自己提供的。所以<span style="background-color: rgba(255, 255, 0, 1)"><strong>Selenium 3</strong>的自动化效率更高，成功率也更高。</span></strong></p>
<p><strong>3、Selenium WebDriver</strong> 支持浏览器众多：</p>
<ul>
<li>Google Chrome</li>
<li>Microsoft Internet Explorer 7，8，9，10，11在 Windows Vista，Windows 7，Windows 8，Windows 8.1.</li>
<li>Microsoft Edge</li>
<li>Firefox</li>
<li>Safari</li>
<li>Opera</li>
</ul>
<p>利用它可以驱动浏览器执行特定的动作，如点击、下拉等操作，同时还可以获取浏览器当前呈现的页面的源代码 ，做到可见即可爬。</p>
<p>所以Selenium现在被广泛用于Python爬虫。查了下资料，发现这个工具确实强大，最重要的是，C#也是可以调用的。</p>
<p>官方支持Java，C#，Python,Ruby，PHP，Perl，Javascript等语言</p>
<p>官方文档（有C#示例）：<a title="https://www.selenium.dev/documentation/en/" href="https://www.selenium.dev/documentation/en/" rel="noopener" target="_blank">https://www.selenium.dev/documentation/en/</a></p>
<a rel="nofollow noopener" name="_label0_0" target="_blank"></a><h3 id="blogTitle1"><strong>1、安装Selenium：</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<p>1、我们新建一个C#控制台程序</p>
<p>2、使用Nuget搜索以下依赖库</p>
<p>需要引用的核心库是<strong>Selenium.RC，Selenium.Support，Selenium.WebDriver</strong></p>
<p>然后再需要引用浏览器驱动库，这里我以新版Edge浏览器为例，新版Edge使用方式跟Chrome是一样的，程序包名称为Selenium.WebDriver.MSEdgeDriver。</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611095634047-1468608640.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611095634726-1698320399.png" alt="image" width="1024" height="470" title="image" border="0" style="border: 0 currentColor; display: inline; background-image: none; border-image: none"></a> <br>备注：也可以在微软<a href="http://go.microsoft.com/fwlink/?LinkId=619687" rel="noopener" target="_blank">WebDriver官网</a>下载Edge (Chromium)的webdriver，需要和当前浏览器版本一致。然后下载放置到项目可执行文件的目录。</p>
<p>如果使用Chrome：</p>
<p>先查下本机Chrome的版本</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611142453796-1630276747.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611142454244-2135433522.png" alt="image" width="885" height="246" title="image" border="0" style="margin: 0; border: 0 currentColor; display: inline; background-image: none; border-image: none"></a></p>
<p>然后去Nuget搜索Selenium.WebDriver.ChromeDriver进行下载安装。</p>
<p>注意：webdriver版本只需要和当前浏览器主版本一致即可。</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611142454596-1612249111.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611142455005-2072668419.png" alt="image" width="665" height="294" title="image" border="0" style="border-width: 0; display: inline; background-image: none; border-image: none"></a></p>
<p>3、在Main函数中输入以下代码</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System;
</span><span style="color: rgba(0, 0, 255, 1)">using</span><span style="color: rgba(0, 0, 0, 1)"> System.Windows.Forms;

</span><span style="color: rgba(0, 0, 255, 1)">namespace</span><span style="color: rgba(0, 0, 0, 1)"> WinForm2
{
    </span><span style="color: rgba(0, 0, 255, 1)">public</span> <span style="color: rgba(0, 0, 255, 1)">partial</span> <span style="color: rgba(0, 0, 255, 1)">class</span><span style="color: rgba(0, 0, 0, 1)"> Form1 : Form
    {
        </span><span style="color: rgba(0, 0, 255, 1)">public</span><span style="color: rgba(0, 0, 0, 1)"> Form1()
        {
            InitializeComponent();
        }

        </span><span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> Form1_Load(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, EventArgs e)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">var</span> service = <span style="background-color: rgba(255, 255, 0, 1)">EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span></span><span style="color: rgba(0, 0, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)">);</span>
            </span><span style="color: rgba(0, 0, 255, 1)">using</span> (IWebDriver driver = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> <span style="background-color: rgba(255, 255, 0, 1)">OpenQA.Selenium.Edge.EdgeDriver(service))</span>
            {
                <span style="background-color: rgba(255, 255, 0, 1)">driver.Navigate().GoToUrl</span>(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span>);  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">driver.Url = "</span><span style="color: rgba(0, 128, 0, 1); text-decoration: underline">http://www.baidu.com</span><span style="color: rgba(0, 128, 0, 1)">"是一样的</span>
                <span style="color: rgba(0, 0, 255, 1)">var</span> source =<span style="color: rgba(0, 0, 0, 1)"> driver.PageSource;
                </span><span style="color: rgba(0, 0, 255, 1)">this</span>.textBox1.Text =<span style="color: rgba(0, 0, 0, 1)"> source;
            }
        }
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>如果是Chrome浏览器，可以这样：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre>IWebDriver driver = <span style="color: rgba(0, 0, 255, 1)"><span style="background-color: rgba(255, 255, 0, 1)">new</span></span><span style="color: rgba(0, 0, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)"> OpenQA.Selenium.Chrome.ChromeDriver();</span>
driver.Navigate().GoToUrl(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<p>运行，会弹出IE浏览器，网页加载完成后，浏览器会自动关闭。控制台输入结果如下</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611095635279-791922746.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611095635810-2113826647.png" alt="image" width="752" height="490" title="image" border="0" style="margin: 0; border: 0 currentColor; display: inline; background-image: none; border-image: none"></a></p>
<p>这样我们就可以轻松的获取动态渲染页面的源码。</p>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label1" target="_blank"></a></div><h2 id="blogTitle2">二、等待<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>常用的等待分为<strong>显示等待WebDriverWait()</strong>、<strong>隐式等待ImplicitlyWait()</strong>、<strong>强制等待sleep()</strong>三种，下面我们就分别介绍一下这三种等待的区别</p>
<ol>
<li><strong>Sleep</strong>()： 强制等待，设置固定休眠时间。</li>
<li><strong>ImplicitlyWait</strong>()：隐式等待，也叫智能等待，是 webdirver 提供的一个超时等待。隐的等待一个元素被发现，或一个命令完成。如果超出了设置时间的则抛出异常。</li>
<li><strong>WebDriverWait</strong>()：显示等待，同样也是 webdirver 提供的方法。在设置时间内，默认每隔一段时间检测一次当前页面元素是否存在，如果超过设置时间检测不到则抛出异常。默认检测频率为0.5s，默认抛出异常为：NoSuchElementException</li>
</ol>
<a rel="nofollow noopener" name="_label1_0" target="_blank"></a><h3 id="blogTitle3">1、<strong>隐式等待：</strong>ImplicitlyWait<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<p>用到Timeouts对象。这个对象是用来对设置器进行一些设置的。</p>
<ul>
<li>ImplicitlyWait：设置脚步在查找（定位）元素时最大的超时时间。如FindElement（）方法在一些超大网页中进行定位时的超时时间。</li>
<li>PageLoad：设置页面操作超时时间（不是页面加载时间）。是在页面进行跳转操作或刷新操作时的等待时间。如Navigation对象的各种操作方法，以及在页面上进行某种操作后的等待时间。</li>
<li>AsynchronousJavaScript： 设置脚步异步执行的超时时间。</li>
</ul>
<p>代码如下:</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>driver.Navigate().GoToUrl(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
ITimeouts timeouts </span>=<span style="color: rgba(0, 0, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)"> driver.Manage().Timeouts();</span>

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置查找元素最大超时时间为30秒</span>
timeouts.<span style="background-color: rgba(255, 255, 0, 1)">ImplicitWait</span> = <span style="color: rgba(0, 0, 255, 1)">new</span> TimeSpan(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">30</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置页面操作最大超时时间为30秒</span>
timeouts.<span style="background-color: rgba(255, 255, 0, 1)">PageLoad</span> = <span style="color: rgba(0, 0, 255, 1)">new</span> TimeSpan(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">30</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置脚本异步最大超时时间为30秒</span>
timeouts.<span style="background-color: rgba(255, 255, 0, 1)">AsynchronousJavaScript</span> = <span style="color: rgba(0, 0, 255, 1)">new</span> TimeSpan(<span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">0</span>, <span style="color: rgba(128, 0, 128, 1)">30</span>);</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<a rel="nofollow noopener" name="_label1_1" target="_blank"></a><h3 id="blogTitle4">2、<strong>显示等待：WebDriverWait()</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待页面元素加载完成
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">默认等待100秒</span>
WebDriverWait <span style="background-color: rgba(255, 255, 0, 1)">wait = <span style="color: rgba(0, 0, 255, 1)">new</span> WebDriverWait</span>(driver, TimeSpan.FromSeconds(<span style="color: rgba(128, 0, 128, 1)">100</span><span style="color: rgba(0, 0, 0, 1)">));
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待页面上ID属性值为submitButton的元素加载完成</span>
IWebElement myElement = <span style="background-color: rgba(255, 255, 0, 1)">wait.Until</span>((d) =&gt;<span style="color: rgba(0, 0, 0, 1)">
{
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> d.FindElement(By.Id(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">submitButton</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
});</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label2" target="_blank"></a></div><h2 id="blogTitle5">三、查找（定位对象）<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>通过FindElement()这个方法来查找的。然后把参数传递过去。</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre>driver.<span style="background-color: rgba(255, 255, 0, 1)">FindElement</span>(By.<span style="background-color: rgba(255, 255, 0, 1)">Id</span> (<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">kw</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).SendKeys(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">搜索关键字</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
driver.<span style="background-color: rgba(255, 255, 0, 1)">FindElement</span>(By.Id( </span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">su</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).Click();</pre>
</div>
<p>其中By.id("su")就是定位参数,传递一个对象过去。有8种定位方式。传递方式如下图：</p>
<p><img src="./03_files/20170112155806962" class="medium-zoom-image"> <br>注意：其中PartialLinkText是模糊查找。比如百度网页中的关于 参数写“关”就可以了，不用写*这种符号。</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">通过ID获取元素</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byID = driver.FindElement(By.Id(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">cards</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">通过类名获取元素by class name</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byClassName = driver.FindElements(By.<span style="background-color: rgba(255, 255, 0, 1)">ClassName</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">menu</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 通过标签名获取元素by tag name </span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byTagName = driver.FindElement(By.<span style="background-color: rgba(255, 255, 0, 1)">TagName</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">iframe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 通过名字获取元素</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byName = driver.FindElement(By.Name(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">__VIEWSTATE</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 通过链接文本获取元素by linked text  <a href="https://www.cnblogs.com/springsnow/p/%3C/span%3E%3Cspan%20style=" rel="noopener">http://www.google.com</a></span><a href="https://www.cnblogs.com/springsnow/p/%3C/span%3E%3Cspan%20style=" rel="noopener"><span style="color: rgba(0, 128, 0, 1)">"&gt;linkedtext</span></a>&gt;  
<span style="color: rgba(0, 0, 255, 1)">var</span> byLinkText = driver.FindElement(By.<span style="background-color: rgba(255, 255, 0, 1)">LinkText</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">linkedtext</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> 通过部分链接文本获取元素by partial link text  :<a href="https://www.cnblogs.com/springsnow/p/%3C/span%3E%3Cspan%20style=" rel="noopener">http://www.google.com</a></span><a href="https://www.cnblogs.com/springsnow/p/%3C/span%3E%3Cspan%20style=" rel="noopener"><span style="color: rgba(0, 128, 0, 1)">"&gt;linkedtext</span></a>&gt;
<span style="color: rgba(0, 0, 255, 1)">var</span> byPartialLinkText = driver.FindElement(By.<span style="background-color: rgba(255, 255, 0, 1)">PartialLinkText</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">text</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">通过CSS选择器获取元素by css</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byCss = driver.FindElement(By.<span style="background-color: rgba(255, 255, 0, 1)">CssSelector</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">#header .content .logo</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">  通过XPath来获取元素(by xpath</span>
<span style="color: rgba(0, 0, 255, 1)">var</span> byXPath = driver.FindElements(By.<span style="background-color: rgba(255, 255, 0, 1)">XPath</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">//div</span><span style="color: rgba(128, 0, 0, 1)">"</span>));</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>各方法使用优先原则：</p>
<p>优先使用id,name,classname,link；次之使用CssSelector()；最后使用Xpath()；</p>
<p>因为Xpath()方法的性能和效率最低下。</p>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label3" target="_blank"></a></div><h2 id="blogTitle6">四、获取页面元素和元素内容<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<a rel="nofollow noopener" name="_label3_0" target="_blank"></a><h3 id="blogTitle7">1.Title：标题<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre>Console.WriteLine(driver.<span style="background-color: rgba(255, 255, 0, 1)">Title</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">输出标题名</span></pre>
</div>
<a rel="nofollow noopener" name="_label3_1" target="_blank"></a><h3 id="blogTitle8">2.Url：链接<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre>Console.WriteLine(driver.<span style="background-color: rgba(255, 255, 0, 1)">Url</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">输出链接</span></pre>
</div>
<a rel="nofollow noopener" name="_label3_2" target="_blank"></a><h3 id="blogTitle9">3.Text：元素的文本值<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 0, 1)"> Console.WriteLine(web.<span style="background-color: rgba(255, 255, 0, 1)">Text</span>);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">输出元素标记中文本的信息</span></pre>
</div>
<a rel="nofollow noopener" name="_label3_3" target="_blank"></a><h3 id="blogTitle10">4.Selected勾选情况、TagName标记名标、Enabled编辑状态、Displayed显示状态<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<a rel="nofollow noopener" name="_label3_4" target="_blank"></a><h3 id="blogTitle11">5.GetAttribute（）获取标签的属性<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> byIDAttributeText = byID.<span style="background-color: rgba(255, 255, 0, 1)">GetAttribute</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">id</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<a rel="nofollow noopener" name="_label3_5" target="_blank"></a><h3 id="blogTitle12">6.弹出对话框的处理<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<p>首先，要先了解三种对话框：Alert、Confirmation以及Prompt。测试网页test.html：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">html</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
    <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">head</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
         <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">title</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>这是标题<span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">title</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
     <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">head</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>

    <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">body</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>
         <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">input </span><span style="color: rgba(255, 0, 0, 1)">type</span><span style="color: rgba(0, 0, 255, 1)">="button"</span><span style="color: rgba(255, 0, 0, 1)"> onclick</span><span style="color: rgba(0, 0, 255, 1)">="alert('这是Alert');"</span><span style="color: rgba(255, 0, 0, 1)"> value</span><span style="color: rgba(0, 0, 255, 1)">="Alert"</span> <span style="color: rgba(0, 0, 255, 1)">/&gt;&lt;</span><span style="color: rgba(128, 0, 0, 1)">br</span><span style="color: rgba(0, 0, 255, 1)">/&gt;</span>
         <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">input </span><span style="color: rgba(255, 0, 0, 1)">type</span><span style="color: rgba(0, 0, 255, 1)">="button"</span><span style="color: rgba(255, 0, 0, 1)"> onclick</span><span style="color: rgba(0, 0, 255, 1)">="confirm('这是confirm');"</span><span style="color: rgba(255, 0, 0, 1)"> value</span><span style="color: rgba(0, 0, 255, 1)">="confirm"</span> <span style="color: rgba(0, 0, 255, 1)">/&gt;&lt;</span><span style="color: rgba(128, 0, 0, 1)">br</span><span style="color: rgba(0, 0, 255, 1)">/&gt;</span>
         <span style="color: rgba(0, 0, 255, 1)">&lt;</span><span style="color: rgba(128, 0, 0, 1)">input </span><span style="color: rgba(255, 0, 0, 1)">type</span><span style="color: rgba(0, 0, 255, 1)">="button"</span><span style="color: rgba(255, 0, 0, 1)"> onclick</span><span style="color: rgba(0, 0, 255, 1)">="prompt('这是Prompt');"</span><span style="color: rgba(255, 0, 0, 1)"> value</span><span style="color: rgba(0, 0, 255, 1)">="prompt"</span> <span style="color: rgba(0, 0, 255, 1)">/&gt;&lt;</span><span style="color: rgba(128, 0, 0, 1)">br</span><span style="color: rgba(0, 0, 255, 1)">/&gt;</span>
     <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">body</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span>


 <span style="color: rgba(0, 0, 255, 1)">&lt;/</span><span style="color: rgba(128, 0, 0, 1)">html</span><span style="color: rgba(0, 0, 255, 1)">&gt;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>下面进行测试：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> service = EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IWebDriver driver </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge.EdgeDriver(service);

driver.Navigate().GoToUrl(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">file:///C:/Users/bobin.yang/Source/Repos/WinForm2/bin/Debug/HTMLPage1.html</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

IWebElement web </span>= driver.FindElement(By.XPath(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">//input[1]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
web.Click();


WebDriverWait wait </span>= <span style="color: rgba(0, 0, 255, 1)">new</span> WebDriverWait(driver, <span style="color: rgba(0, 0, 255, 1)">new</span> TimeSpan(<span style="color: rgba(128, 0, 128, 1)">0</span>,<span style="color: rgba(128, 0, 128, 1)">0</span>,<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">));
 </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">Wait for the alert to be displayed</span>
<span style="color: rgba(0, 0, 0, 1)"> wait.Until(ExpectedConditions.AlertIsPresent());

Console.WriteLine(</span><span style="color: rgba(0, 0, 0, 1)">driver.SwitchTo().Alert().Text</span><span style="color: rgba(0, 0, 0, 1)">);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">在接收消息前输出</span>
System.Threading.Thread.Sleep(<span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
<span style="background-color: rgba(255, 255, 0, 1)">driver.SwitchTo().Alert().Accept();
</span>

IWebElement web2 </span>= driver.FindElement(By.XPath(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">//input[2]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
web2.Click();
WebDriverWait wait2 </span>= <span style="color: rgba(0, 0, 255, 1)">new</span> WebDriverWait(driver, TimeSpan.FromSeconds(<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">));
wait2.Until(ExpectedConditions.AlertIsPresent());
Console.WriteLine(driver.SwitchTo().Alert().Text);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">在接收消息前输出</span>
System.Threading.Thread.Sleep(<span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
<span style="background-color: rgba(255, 255, 0, 1)">driver.SwitchTo().Alert().Accept();</span>


IWebElement web3 </span>= driver.FindElement(By.XPath(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">html/body/input[3]</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
web3.Click();
System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(driver.SwitchTo().Alert().Text);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">在接收消息前输出</span>
<span style="background-color: rgba(255, 255, 0, 1)">driver.SwitchTo().Alert().SendKeys(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">这是输入的内容</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
driver.SwitchTo().Alert().Accept();</span></span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label4" target="_blank"></a></div><h2 id="blogTitle13">五、操作元素对象WebElement<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>主要是进行Click和SendKeys操作，如图。其它的自己查看定义就知道了。 <br><img src="./03_files/20170112163055082" class="medium-zoom-image"></p>
<a rel="nofollow noopener" name="_label4_0" target="_blank"></a><h3 id="blogTitle14">1、模拟鼠标点击元素<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre>driver.FindElement(By.Id(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">copyright</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).<span style="background-color: rgba(255, 255, 0, 1)">Click();</span></pre>
</div>
<ol>
<li>SenKeys就是在定位到输入框后，把参数text赋值进去</li>
<li>Click就是进行鼠标点击操作，比如点击按钮等。和IDE上一样的。单选、复选都是通过这个方法这点击的。</li>
<li>Clear方法：是用于清空输入框的值，和SendKeys正好的作用正好相反。自己测试时，建议先给输入框赋值，再用Thread.Sleep（3000）来暂停一下，再用Clear方法，不然你还没看到效果时，程序已经完成了。</li>
<li>Submit：特殊之处在于，当定位的是Form表单中任何一个元素，当操作完之后，直接调用那个Submit方法就能对整个Form表单完成提交。不用再返回重新查找表单元素。</li>
</ol>
<p><strong>Selenium中在指定的文本框中输入指定的字符串</strong></p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">在文本框中输入指定的字符串sendkeys()</span>
Driver.FindElement(By.Id(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">tranAmtText</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).<span style="background-color: rgba(255, 255, 0, 1)">SendKeys(“<span style="color: rgba(128, 0, 128, 1)">123456</span>”)；</span></pre>
</div>
<a rel="nofollow noopener" name="_label4_1" target="_blank"></a><h3 id="blogTitle15"><strong>2、下拉列表框Select的操作</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>driver.Navigate().GoToUrl(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://tieba.baidu.com/f/search/adv</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IList</span> listOption = driver.FindElement(By.Name(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">sm</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).FindElements(By.TagName(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">option</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
</span><span style="color: rgba(0, 0, 255, 1)">string</span> targetStr = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">按相关性排序</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> option <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> listOption)
{
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (option.Text == targetStr)  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> if (option.GetAttribute("value").Equals(targetStr))</span>
<span style="color: rgba(0, 0, 0, 1)">        <span style="background-color: rgba(255, 255, 0, 1)">option.Click();</span>
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<a rel="nofollow noopener" name="_label4_2" target="_blank"></a><h3 id="blogTitle16"><strong>2、执行JS</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> jsReturnValue = (IWebElement)((IJavaScriptExecutor)driver).<span style="background-color: rgba(255, 255, 0, 1)">ExecuteScript</span>(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">jsfunname</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<a rel="nofollow noopener" name="_label4_3" target="_blank"></a><h3 id="blogTitle17"><strong>3、页面导航 </strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 0, 1)">driver.<span style="background-color: rgba(255, 255, 0, 1)">Navigate().Forward();</span>
driver.<span style="background-color: rgba(255, 255, 0, 1)">Navigate().Back();</span></span></pre>
</div>
<p><strong>Selenium中</strong><a rel="noopener" target="_blank"><strong>移动</strong></a><strong>光标到指定的元素上</strong></p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">移动光标到指定的元素上perform</span>
Actions action=<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Actions(driver)；
action.<span style="background-color: rgba(255, 255, 0, 1)">MoveToElement</span>(Find(By.XPath(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">//input[@id='submit' and @value='确定']</span><span style="color: rgba(128, 0, 0, 1)">"</span>))).Perform();</pre>
</div>
<a rel="nofollow noopener" name="_label4_4" target="_blank"></a><h3 id="blogTitle18"><strong>4、拖拽操作(可以实现滑动验证码的验证)</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> element = driver.FindElement(By.Name(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">source</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
IWebElement target </span>= driver.FindElement(By.Name(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">target</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
(</span><span style="color: rgba(0, 0, 255, 1)">new</span> Actions(driver)).<span style="background-color: rgba(255, 255, 0, 1)">DragAndDrop</span>(element, target).Perform();</pre>
</div>
<a rel="nofollow noopener" name="_label4_5" target="_blank"></a><h3 id="blogTitle19"><strong>5、模拟鼠标晃动</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">模拟光标晃动movebyoffset()</span>
Actions action = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> Actions(driver);
action.<span style="background-color: rgba(255, 255, 0, 1)">MoveByOffse</span><span style="background-color: rgba(255, 255, 0, 1)">t</span>(</span><span style="color: rgba(128, 0, 128, 1)">2</span>, <span style="color: rgba(128, 0, 128, 1)">4</span>);</pre>
</div>
<a rel="nofollow noopener" name="_label4_6" target="_blank"></a><h3 id="blogTitle20"><strong>6、截图功能</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">WebDriver中自带截图功能</span>
Screenshot screenShotFile =<span style="color: rgba(0, 0, 0, 1)"> ((ITakesScreenshot)driver<span style="background-color: rgba(255, 255, 0, 1)">).GetScreenshot();</span>
screenShotFile.SaveAsFile(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">test</span><span style="color: rgba(128, 0, 0, 1)">"</span>, ImageFormat.Jpeg);</pre>
</div>
<a rel="nofollow noopener" name="_label4_7" target="_blank"></a><h3 id="blogTitle21">7、selenium操作滚轮滑动到底部<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code">
<pre>driver.execute_script(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">window.scrollTo(0,document.body.scrollHeight);</span><span style="color: rgba(128, 0, 0, 1)">"</span>)</pre>
</div>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label5" target="_blank"></a></div><h2 id="blogTitle22"><strong>六、获得窗口标识WindowHandles</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>要在不同的浏览器窗口之间切换，必须获得不同的窗口（标签）的标识符。用一个集合来保存这些数据。当需要到新窗口里进行操作时，需要将测试器前往新的窗口。开始创建的测试器是对窗口来的，所以当我们需要切换窗口时。需要调用 测试器.SwitchTo().window(获得标识) 这个方法来返回一个新的测试器对象。新的对象是代表的是切换的窗口。代码如下：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> service = EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IWebDriver driver </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge.EdgeDriver(service);

driver.Navigate().GoToUrl(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://tieba.baidu.com/f/search/adv</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">找到注册元素</span>
IWebElement register = driver.FindElement(By.XPath(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.//*[@id='com_userbar']/ul/li[5]/div/a</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
register.Click();

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">显示所有标识</span>
IList&lt;<span style="color: rgba(0, 0, 255, 1)">string</span>&gt; listHand = <span style="background-color: rgba(255, 255, 0, 1)">driver.WindowHandles</span>;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">拿到所有标识</span>
<span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">string</span> item <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> listHand)
{
    Console.WriteLine(item);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">这里一会插入代码</span><span style="color: rgba(0, 128, 0, 1)">*/</span><span style="color: rgba(0, 0, 0, 1)">

Console.ReadKey();
driver.Quit();</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>效果如下：</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611151615405-391315340.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611151616122-1278381071.png" alt="image" width="640" height="306" title="image" border="0" style="border: 0 currentColor; display: inline; background-image: none; border-image: none"></a></p>
<p>下面切换到新打开的窗口后，输入一个12345来表示我们成功了 <br> 在上面的代码基础下 添加下面代码</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换到注册窗口再输入12345</span>
driver.SwitchTo().<span style="background-color: rgba(255, 255, 0, 1)">Window(listHand[<span style="color: rgba(128, 0, 128, 1)">1</span></span><span style="color: rgba(0, 0, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)">]);</span>
driver.FindElement(By.Name(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">userName</span><span style="color: rgba(128, 0, 0, 1)">"</span>)).SendKeys(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">12345</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<p>结果如图：</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611105746590-1470856352.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611105747012-435619532.png" alt="image" width="606" height="345" title="image" border="0" style="margin: 0; border: 0 currentColor; display: inline; background-image: none; border-image: none"></a></p>
<a rel="nofollow noopener" name="_label5_0" target="_blank"></a><h3 id="blogTitle23"><strong>1、关闭多个子Browser窗口</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">获取所有的WindowHandle，关闭所有子窗口</span>
<span style="color: rgba(0, 0, 255, 1)">string</span> oldwin =<span style="color: rgba(0, 0, 0, 1)"> driver.CurrentWindowHandle;
ReadOnlyCollection</span>&lt;<span style="color: rgba(0, 0, 255, 1)">string</span>&gt; windows =<span style="color: rgba(0, 0, 0, 1)"> driver.WindowHandles;
</span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> win <span style="color: rgba(0, 0, 255, 1)">in</span><span style="color: rgba(0, 0, 0, 1)"> windows)
{
    </span><span style="color: rgba(0, 0, 255, 1)">if</span> (win !=<span style="color: rgba(0, 0, 0, 1)"> oldwin)
    {
        driver.<span style="background-color: rgba(255, 255, 0, 1)">SwitchTo().Window(win).Close();</span>
    }
}
driver.SwitchTo().Window(oldwin);</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<a rel="nofollow noopener" name="_label5_1" target="_blank"></a><h3 id="blogTitle24"><strong>2、对iframe中元素的定位</strong><button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h3>
<p>1、切换焦点到id为固定值的iframe上</p>
<p>进入页面后，光标默认焦点在DefaultContent中，若想要定位到iframe 需要转换焦点</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none">
<pre><span style="color: rgba(0, 0, 0, 1)">driver.SwitchTo().DefaultContent();
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换焦点到mainFrame</span>
driver.SwitchTo().Frame(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">mainFrame</span><span style="color: rgba(128, 0, 0, 1)">"</span>);</pre>
</div>
<p>需要注意的是：切换焦点之后若想切换焦点到其他iframe上 需要先返回到defaultcontent，再切换焦点到指定的iframe上。</p>
<p>2、切换焦点到id值为动态值的iframe上</p>
<p>有时候 页面上浮出层的id为动态值，此时需要先获取所有符合记录的iframe放置在数组中，然后遍历数组切换焦点到目标iframe上。</p>
<p>如下方法：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">protected</span> <span style="color: rgba(0, 0, 255, 1)">string</span> bizFrameId = <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.Empty;
</span><span style="color: rgba(0, 0, 255, 1)">protected</span> <span style="color: rgba(0, 0, 255, 1)">string</span> bizId = <span style="color: rgba(0, 0, 255, 1)">string</span><span style="color: rgba(0, 0, 0, 1)">.Empty;
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">获取动态iframe的id值</span>
<span style="color: rgba(0, 0, 255, 1)">protected</span> <span style="color: rgba(0, 0, 255, 1)">void</span><span style="color: rgba(0, 0, 0, 1)"> SetIframeId()
{
    ReadOnlyCollection</span> els = driver.FindElements(By.TagName(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">iframe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">));
    </span><span style="color: rgba(0, 0, 255, 1)">foreach</span> (<span style="color: rgba(0, 0, 255, 1)">var</span> e <span style="color: rgba(0, 0, 255, 1)">in</span> driver.FindElements(By.TagName(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">iframe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)))
    {
        </span><span style="color: rgba(0, 0, 255, 1)">string</span> s1 = e.GetAttribute(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">id</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (s1.IndexOf(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">window</span><span style="color: rgba(128, 0, 0, 1)">"</span>) &gt;= <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; s1.IndexOf(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">content</span><span style="color: rgba(128, 0, 0, 1)">"</span>) &gt;= <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            bizFrameId </span>= e.GetAttribute(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">id</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            </span><span style="color: rgba(0, 0, 255, 1)">string</span>[] ss = s1.Split(<span style="color: rgba(0, 0, 255, 1)">new</span> <span style="color: rgba(0, 0, 255, 1)">char</span>[] { <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">_</span><span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)"> });
            bizId </span>= ss[<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">];
        }
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label6" target="_blank"></a></div><h2 id="blogTitle25">七、Cookies<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>在C#中，通过Cookies属性来获取当前的Cookie集合，然后进行增删改查操作。</p>
<p>Cookie由5个部分组成：名称、值、所在域、路径和过期时间。</p>
<p>下面我们进入百度首页，然后获取cookie，并让它变动一下来看到效果。 代码如下:</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> service = EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IWebDriver driver </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge.EdgeDriver(service);

driver.Navigate().GoToUrl(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);


</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">获取Cookie</span>
ICookieJar listCookie =<span style="color: rgba(0, 0, 0, 1)"> <span style="background-color: rgba(255, 255, 0, 1)">driver.Manage().Cookies;</span>
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> IList listCookie = driver.Manage( ).Cookies.AllCookies;</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">只是显示 可以用Ilist对象
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">显示初始Cookie的内容</span>
Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">--------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">当前Cookie集合的数量：\t{listCookie.AllCookies.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = <span style="color: rgba(128, 0, 128, 1)">0</span>; i &lt; listCookie.AllCookies.Count; i++<span style="color: rgba(0, 0, 0, 1)">)
{

    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的名称:{listCookie.AllCookies[i].Name}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的值:{listCookie.AllCookies[i].Value}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的所在域:{listCookie.AllCookies[i].Domain}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的路径:{listCookie.AllCookies[i].Path}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的过期时间:{listCookie.AllCookies[i].Expiry}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}


</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">添加一个新的Cookie</span>
Cookie newCookie = <span style="color: rgba(0, 0, 255, 1)">new</span> Cookie(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">新Cookie</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">新值</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">""</span>, DateTime.Now.AddDays(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">));

listCookie.AddCookie(newCookie);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">--------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">当前Cookie集合的数量：\t{listCookie.AllCookies.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
</span><span style="color: rgba(0, 0, 255, 1)">for</span> (<span style="color: rgba(0, 0, 255, 1)">int</span> i = <span style="color: rgba(128, 0, 128, 1)">0</span>; i &lt; listCookie.AllCookies.Count; i++<span style="color: rgba(0, 0, 0, 1)">)
{

    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的名称:{listCookie.AllCookies[i].Name}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的值:{listCookie.AllCookies[i].Value}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的所在域:{listCookie.AllCookies[i].Domain}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的路径:{listCookie.AllCookies[i].Path}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Cookie的过期时间:{listCookie.AllCookies[i].Expiry}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">删除这个Cookie并再次显示总数</span>
<span style="color: rgba(0, 0, 0, 1)">listCookie.DeleteCookieNamed(newCookie.Name);

Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">当前Cookie集合的数量：\t{listCookie.AllCookies.Count}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);


Console.ReadLine();
driver.Quit();</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>运行效果如下：</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611105747322-963391049.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611105747735-1119097582.png" alt="image" width="343" height="261" title="image" border="0" style="margin: 0; border: 0 currentColor; display: inline; background-image: none; border-image: none"></a></p>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label7" target="_blank"></a></div><h2 id="blogTitle26">八、Window窗口控制<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>这个属性是可以对当前的窗口进行简单的控制。如获取坐标和大小，还可以将其最大化。下面我们用过示例代码来试试效果。 <br> 下面的代码是先打开网页，打印坐标和大小，再控制它最大化，再次打印坐标和大小。</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> service = EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IWebDriver driver </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge.EdgeDriver(service);

driver.Navigate().GoToUrl(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">打印现在的坐标和大小</span>
IWindow window =<span style="color: rgba(0, 0, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)"> driver.Manage().Window;</span>
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">第一次打印</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">坐标X为{window.Position.X}\tY为{window.Position.Y}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">大小长为{window.Size.Width}\t宽为{window.Size.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">控制最大化</span>
<span style="color: rgba(0, 0, 0, 1)">window<span style="background-color: rgba(255, 255, 0, 1)">.Maximize();</span>

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">再次打印数据</span>
Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">第二次打印</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">坐标X为{window.Position.X}\tY为{window.Position.Y}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine($</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">大小长为{window.Size.Width}\t宽为{window.Size.Height}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

Console.ReadLine();
driver.Quit();</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>效果如下:</p>
<p><a href="https://img2020.cnblogs.com/blog/24244/202006/24244-20200611105748035-1602991555.png" rel="noopener" target="_blank"><img src="./03_files/24244-20200611105748368-1879569953.png" alt="image" width="334" height="159" title="image" border="0" style="margin: 0; border: 0 currentColor; display: inline; background-image: none; border-image: none"></a> <br>这里有两个奇怪的地方： 

  <br>1.我的屏幕是1080P的，输出后的数据中，长只有1936.如果减去16的话到正好是1920.但是宽应该是1080，如果任务栏的宽度是24的话，到也能说得过去。只是数据和我们要的有点偏差，这里需要注意一下。 

  <br>2.window属性居然只有位置、大小和最大化方法。居然没有最小化或还原（退出最大化状态）方法。</p>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label8" target="_blank"></a></div><h2 id="blogTitle27">九、事件<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>首先是准备好要添加的事件，然后再挂接。这里可以使用C#的语法糖。在+=后面直接按两次tab键，然后再移动到事件区编辑。</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>eventDriver.Navigating += EventDriver_Navigating;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">导航前</span>
eventDriver.Navigated += EventDriver_Navigated;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">导航后</span>
eventDriver.FindingElement += EventDriver_FindingElement;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">查找元素前</span>
eventDriver.FindElementCompleted += EventDriver_FindElementCompleted;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">查找元素后</span>
eventDriver.ElementClicking += EventDriver_ElementClicking;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">元素单击前</span>
eventDriver.<span style="background-color: rgba(255, 255, 0, 1)">ElementClicked += EventDriver_ElementClicked;</span><span style="color: rgba(0, 128, 0, 1)"><span style="background-color: rgba(255, 255, 0, 1)">/</span>/</span><span style="color: rgba(0, 128, 0, 1)">元素单击后</span>
eventDriver.ElementValueChanging += EventDriver_ElementValueChanging;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">元素值改变前</span>
eventDriver.ElementValueChanged += EventDriver_ElementValueChanged;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">元素值改变后</span>
eventDriver.ExceptionThrown += EventDriver_ExceptionThrown;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">异常发生后事件</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>挂接事件：</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">#region</span> 事件区

<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 导航前发生的事件
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_Navigating(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebDriverNavigationEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">即将要跳转到的URL为：{e.Driver.Url}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 导航后发生的事件
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_Navigated(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebDriverNavigationEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">跳转到的URL为：{e.Driver.Url}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 查找元素前发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_FindingElement(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, FindElementEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">即将查找的元素为：{e.FindMethod.ToString()}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 查找元素后发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_FindElementCompleted(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, FindElementEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">找到元素，条件为：{e.FindMethod.ToString()}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 单击元素前发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_ElementClicking(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebElementEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">要单击的元素的value属性为：{e.Element.GetAttribute(</span><span style="color: rgba(128, 0, 0, 1)">"</span>value<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">)}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 单击元素后发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_ElementClicked(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebElementEventArgs e)
{
    System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">3</span> * <span style="color: rgba(128, 0, 128, 1)">1000</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">暂停3秒</span>
    <span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">单击元素后，现在的URL为：{e.Driver.Url}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 单击元素前发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_ElementValueChanging(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebElementEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">元素更改前的值为：{e.Element.GetAttribute(</span><span style="color: rgba(128, 0, 0, 1)">"</span>value<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">)}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 单击元素后发生
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_ElementValueChanged(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebElementEventArgs e)
{
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">元素更改后的值为：{e.Element.GetAttribute(</span><span style="color: rgba(128, 0, 0, 1)">"</span>value<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">)}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span><span style="color: rgba(0, 128, 0, 1)"> 异常(保存截图到本地)
</span><span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(128, 128, 128, 1)">///</span> 
<span style="color: rgba(0, 0, 255, 1)">private</span> <span style="color: rgba(0, 0, 255, 1)">void</span> EventDriver_ExceptionThrown(<span style="color: rgba(0, 0, 255, 1)">object</span><span style="color: rgba(0, 0, 0, 1)"> sender, WebDriverExceptionEventArgs e)
{
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">地址</span>
    <span style="color: rgba(0, 0, 255, 1)">string</span> strPath = $<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">D:\Desktop\{DateTime.Now.ToString(</span><span style="color: rgba(128, 0, 0, 1)">"</span>yyyy-MM-dd HH-mm-ss<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">)}.png</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">;

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">保存截图</span>
    Screenshot screen = (sender <span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)"> EventFiringWebDriver).GetScreenshot();
    screen.SaveAsFile(strPath, System.Drawing.Imaging.ImageFormat.Png);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">输出保存信息</span>
    <span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-----------------------------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">this</span>.listMeassage.Add($<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">发生异常，截图已保存到：{strPath}</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
<div style="text-align: right;"><a rel="nofollow noopener" name="_label9" target="_blank"></a></div><h2 id="blogTitle28">十、关闭浏览器<button class="cnblogs-toc-button" title="显示目录导航" aria-expanded="false"></button></h2>
<p>有下面两种：</p>
<ol>
<li><strong>Close</strong>():关闭WedDriver对象所在的窗口； <br>第一个是关闭一个窗口，一个wedDriver对象是可以有多个窗口的（之前的窗口切换也是提到过），需要关闭时要保证当前激活的窗口。比如一个wedDriver对象里有好多个窗口，你要关闭第2个窗口，就要用SwitchTo().Window()方法切换到第2个窗口才能关闭，不能直接关闭第几个窗口的。</li>
<li><strong>Quit</strong>():关闭所有相关窗口；

    <br>第二个关闭和这个webDriver对象所有相关的窗口。当然，一个脚本是可以有多个webDriver对象</li>

</ol>
<p>下面代码的代码展示这了两个方法的用法和用途。 
  <br>1.打开百度首页，单击“注册”超级链接。 

  <br>2.在弹出的窗口（百度账户注册）中，调用Close（）方法，关闭新弹出的页面 

  <br>3.再一次点击“注册”超级链接，调用Quit（）方法来结束测试。</p>
<div class="cnblogs_code" style="padding: 5px; border: 1px solid rgba(204, 204, 204, 1); background-color: rgba(245, 245, 245, 1); border-image: none"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 255, 1)">var</span> service = EdgeDriverService.CreateDefaultService(<span style="color: rgba(128, 0, 0, 1)">@"</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">"</span>, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">msedgedriver.exe</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
IWebDriver driver </span>= <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)"> OpenQA.Selenium.Edge.EdgeDriver(service);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">导航到百度首页</span>
driver.Navigate().GoToUrl(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">http://www.baidu.com</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">进行点击</span>
Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">进行点击</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
driver.FindElement(By.LinkText(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">登录</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)).Click();
System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">3</span> * <span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
driver.FindElement(By.LinkText(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">立即注册</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)).Click();

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">获取窗口句柄</span>
IList&lt;<span style="color: rgba(0, 0, 255, 1)">string</span>&gt; listHand =<span style="color: rgba(0, 0, 0, 1)"> driver.WindowHandles;

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换到注册窗口并关闭</span>
Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">切换到注册窗口</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
driver.SwitchTo().Window(listHand[</span><span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">]);
System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">3</span> * <span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">关闭注册窗口</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
<span style="background-color: rgba(255, 255, 0, 1)">driver.Close();</span>
System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">3</span> * <span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换到主窗口并结束测试</span>
Console.WriteLine(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">-------------------</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
Console.WriteLine(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">切换到主窗口并结束测试</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
driver.SwitchTo().Window(listHand[</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">]);
driver.FindElement(By.LinkText(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">立即注册</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">)).Click();
System.Threading.Thread.Sleep(</span><span style="color: rgba(128, 0, 128, 1)">3</span> * <span style="color: rgba(128, 0, 128, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">);
<span style="background-color: rgba(255, 255, 0, 1)">driver.Quit();</span>

Console.ReadLine();</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./03_files/copycode.gif" alt="复制代码"></a></span></div></div>
</div>
<div class="clear"></div>
<div id="blog_post_info_block" role="contentinfo"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/springsnow/category/1266011.html" target="_blank">15 WinForm</a>,             <a href="https://www.cnblogs.com/springsnow/category/1266013.html" target="_blank">20 三方控件</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(13088186,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
        <a id="green_channel_follow" onclick="follow(&#39;b1783d0b-63cf-dd11-9e4d-001cf0cd104b&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./03_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./03_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/springsnow/" target="_blank"><img src="./03_files/sample_face.gif" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/springsnow/">springsnow</a><br>
            <a href="https://home.cnblogs.com/u/springsnow/followers/">粉丝 - <span class="follower-count">96</span></a>
            <a href="https://home.cnblogs.com/u/springsnow/followees/">关注 - <span class="following-count">5</span></a><br>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow" class="follow-tip">
                <a href="javascript:void(0);" onclick="follow(&#39;b1783d0b-63cf-dd11-9e4d-001cf0cd104b&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(13088186,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">2</span>
    </div>
    <div class="buryit" onclick="votePost(13088186,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/springsnow/p/13295129.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/springsnow/p/13295129.html" data-featured-image="" title="发布于 2020-06-10 19:12">ＭongoDB（08）：索引</a>
    <br>
    <a href="https://www.cnblogs.com/springsnow/p/13093956.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/springsnow/p/13093956.html" data-featured-image="" title="发布于 2020-06-11 16:16">ＭongoDB（10）：在C#中使用MongoDB</a>

</div>
</div>
        </div>
        <p class="postfoot">
            posted on 
<span id="post-date">2020-06-10 19:44</span>&nbsp;
<a href="https://www.cnblogs.com/springsnow/">springsnow</a>&nbsp;
阅读(<span id="post_view_count">4392</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=13088186" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(13088186);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: &#39;&#39;, targetType: &#39;blogPost&#39;, targetId: &#39;13088186&#39;, targetLink: &#39;https://www.cnblogs.com/springsnow/p/13088186.html&#39;, title: &#39;C#爬虫（03）：使用Selenium&#39; })">举报</a>
        </p>
    </div>
</div>


<script>
    var cb_entryId = 13088186, cb_entryCreatedDate = '2020-06-10 19:44', cb_postType = 1, cb_postTitle = 'C#爬虫（03）：使用Selenium';
    var allowComments = true, cb_blogId = 27803, cb_blogApp = 'springsnow', cb_blogUserGuid = 'b1783d0b-63cf-dd11-9e4d-001cf0cd104b';
    mermaidRender.render()
    markdown_highlight()
    zoomManager.apply("#cnblogs_post_body img:not(.code_img_closed):not(.code_img_opened)");
    updatePostStats(
            [cb_entryId],
            function(id, count) { $("#post_view_count").text(count) },
            function(id, count) { $("#post_comment_count").text(count) })
</script>
<a id="!comments"></a>
<div id="blog-comments-placeholder"></div>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/springsnow/p/13088186.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/springsnow/p/13088186.html#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    登录后才能查看或发表评论，立即 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return account.login(&#39;!comments&#39;);">登录</a> 或者
    <a href="https://www.cnblogs.com/">逛逛</a> 博客园首页
</div>
</div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
        <div id="cnblogs_ch"></div>
    <div id="opt_under_post"></div>
    <div id="cnblogs_c1" class="under-post-card">
            <div id="div-gpt-ad-1592365906576-0" style="width: 300px; height: 250px;" data-google-query-id="CN6a38uR3PoCFRSylgodsRoL6Q"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" name="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="1" src="./03_files/saved_resource.html"></iframe></div></div>
    </div>
    <div id="under_post_card1"><div class="under-post-card">
<b>编辑推荐：</b>
<br>

· <a href="https://www.cnblogs.com/oyuyue/p/16777638.html" target="_blank">斗鱼 H5 直播原理解析，它是如何省了 80% 的 CDN 流量？ </a>
    <br>
· <a href="https://www.cnblogs.com/coco1s/p/16774696.html" target="_blank">超强的纯 CSS 鼠标点击拖拽效果</a>
    <br>
· <a href="https://www.cnblogs.com/tangshiye/p/16768880.html" target="_blank">新零售SaaS架构：中央库存系统架构设计</a>
    <br>
· <a href="https://www.cnblogs.com/kklldog/p/Native-aot.html" target="_blank">不安装运行时运行 .NET 程序 - NativeAOT </a>
    <br>
· <a href="https://www.cnblogs.com/huangxincheng/p/16759052.html" target="_blank">从 C# 崩溃异常 中研究页堆布局</a>
    <br>
</div></div>
    <div id="under_post_card2"><div class="itnews under-post-card">
    <b>最新新闻</b>：
    <br>
 ·          <a href="https://news.cnblogs.com/n/729715/" target="_blank">微软秋季发布会：5G版Surface Pro亮相 加深与苹果生态融合</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/729714/" target="_blank">扎克伯格谈新款万元VR头显：成本价，我们不像苹果那样定高价</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/729713/" target="_blank">比亚迪×奔驰的火爆新车，让我开到半夜不回家</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/729712/" target="_blank">抖音集团上线新 Logo</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/729711/" target="_blank">腾讯视频否认将接入 88VIP</a>
        <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="under-post-card">
<b>历史上的今天：</b>
<br>

2011-06-10    <a href="https://www.cnblogs.com/springsnow/archive/2011/06/10/2077553.html">C#（99）：自定义集合类</a>
    <br>
</div>
    <script type="text/javascript">
        var commentManager = new blogCommentManager();
        commentManager.renderComments(0);
        fixPostBody();

            window.tocManager.displayDisableTocTips = false;
            window.tocManager.generateToc();
            
                setTimeout(function() { countViews(cb_blogId, cb_entryId); }, 50);
            
            deliverT2();
            deliverC1C2();
            loadNewsAndKb();
            
                LoadPostCategoriesTags(cb_blogId, cb_entryId);
            
            LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
            GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
            loadOptUnderPost();
            GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
                </script>
</div>



</div>
</div>
<div id="leftmenu">


<h3>导航</h3>
<ul>
    <li>
        <a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>

    </li>
    <li>
        
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/springsnow/">
首页</a>

    </li>
    <li>
        



    </li>
    <li>
        

    </li>
    <li>
        
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/springsnow/rss/">
订阅</a>
        
<a id="blog_nav_rss_image" href="https://www.cnblogs.com/springsnow/rss/">
    <img src="./03_files/xml.gif" alt="订阅">
</a>
    </li>
    <li>
        
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>

    </li>
</ul>


<div id="blog-calendar" style="display:none"></div><script>loadBlogDefaultCalendar();</script>

<div id="sidebar_c3"></div>
<div id="blog-sidecolumn"><!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            
        </div>
    </div>
</div>

<!-- 常用链接 -->


<!-- 最新随笔 -->


<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block">
<h3>我的标签</h3>
<div id="MyTag">
    <ul>
                <li>
            <a href="https://www.cnblogs.com/springsnow/tag/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式<span class="tag-count">(24)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/C%23%E8%AF%AD%E8%A8%80%E6%96%B0%E7%89%B9%E6%80%A7/">C#语言新特性<span class="tag-count">(10)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/DevExpress/">DevExpress<span class="tag-count">(9)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B/">并行编程<span class="tag-count">(9)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/%E6%8A%A5%E8%A1%A8/">报表<span class="tag-count">(5)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/git/">git<span class="tag-count">(4)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/Socket/">Socket<span class="tag-count">(4)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/WCF/">WCF<span class="tag-count">(3)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/ADO.NET/">ADO.NET<span class="tag-count">(3)</span></a>
        </li>
        <li>
            <a href="https://www.cnblogs.com/springsnow/tag/VS%20Code/">VS Code<span class="tag-count">(3)</span></a>
        </li>
    <li>
        <a href="https://www.cnblogs.com/springsnow/tag/">更多</a>
    </li>

    </ul>
</div>
</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">

    <h3>
        
    <a class="sidebar-card-title-a" href="https://www.cnblogs.com/springsnow/categories">随笔分类</a>
<span class="sidebar-category-item-count">
    (938)
</span>


    </h3>
    <ul>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1813148.html" class="category-item-link" rel="" target="">00 常用知识(5)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1592942.html" class="category-item-link" rel="" target="">01 HTML(17)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/246152.html" class="category-item-link" rel="" target="">02 CSS(24)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/246223.html" class="category-item-link" rel="" target="">03 JavaScript(47)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1793399.html" class="category-item-link" rel="" target="">04 TypeScript(24)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1793988.html" class="category-item-link" rel="" target="">05 Vue(7)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1561979.html" class="category-item-link" rel="" target="">06 JQuery(38)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1793991.html" class="category-item-link" rel="" target="">08 Echarts(12)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1624236.html" class="category-item-link" rel="" target="">09 BootStrap(33)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/246150.html" class="category-item-link" rel="" target="">12 C#语言基础(130)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/247448.html" class="category-item-link" rel="" target="">13 Visual Studio(40)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1266011.html" class="category-item-link" rel="" target="">15 WinForm(38)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1266012.html" class="category-item-link" rel="" target="">16 ASP.NET(26)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1543257.html" class="category-item-link" rel="" target="">17 ASP.NET Core(19)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1798420.html" class="category-item-link" rel="" target="">18 EF Core(10)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1265993.html" class="category-item-link" rel="" target="">19 .NET设计模式(29)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1266013.html" class="category-item-link" rel="" target="">20 三方控件(65)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1265997.html" class="category-item-link" rel="" target="">21 Oracle(32)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1272178.html" class="category-item-link" rel="" target="">22 SqlServer(55)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1769613.html" class="category-item-link" rel="" target="">23 MongoDB(11)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1865952.html" class="category-item-link" rel="" target="">30 ABP(54)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1592943.html" class="category-item-link" rel="" target="">31 Python(91)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/2159044.html" class="category-item-link" rel="" target="">40 GitHub项目(1)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1567519.html" class="category-item-link" rel="" target="">50 Office(19)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1265994.html" class="category-item-link" rel="" target="">51 SoftWare分享(43)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1631691.html" class="category-item-link" rel="" target="">53 Linux系统(24)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1266015.html" class="category-item-link" rel="" target="">55 非技术(22)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1599011.html" class="category-item-link" rel="" target="">88 微信开发(12)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/category/1476535.html" class="category-item-link" rel="" target="">99 English Learning(10)</a>

            </li>
        
    </ul>
    <h3>
        
随笔档案<span class="sidebar-category-item-count">
    (891)
</span>


    </h3>
    <ul>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2022/05.html" class="category-item-link" rel="" target="">2022年5月(22)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2022/04.html" class="category-item-link" rel="" target="">2022年4月(2)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2022/02.html" class="category-item-link" rel="" target="">2022年2月(5)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/11.html" class="category-item-link" rel="" target="">2021年11月(4)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/09.html" class="category-item-link" rel="" target="">2021年9月(1)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/08.html" class="category-item-link" rel="" target="">2021年8月(2)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/07.html" class="category-item-link" rel="" target="">2021年7月(9)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/06.html" class="category-item-link" rel="" target="">2021年6月(3)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/05.html" class="category-item-link" rel="" target="">2021年5月(2)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/04.html" class="category-item-link" rel="" target="">2021年4月(1)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/03.html" class="category-item-link" rel="" target="">2021年3月(2)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2021/01.html" class="category-item-link" rel="" target="">2021年1月(1)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/12.html" class="category-item-link" rel="" target="">2020年12月(6)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/11.html" class="category-item-link" rel="" target="">2020年11月(8)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/10.html" class="category-item-link" rel="" target="">2020年10月(61)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/09.html" class="category-item-link" rel="" target="">2020年9月(22)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/08.html" class="category-item-link" rel="" target="">2020年8月(6)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/07.html" class="category-item-link" rel="" target="">2020年7月(39)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/06.html" class="category-item-link" rel="" target="">2020年6月(80)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/05.html" class="category-item-link" rel="" target="">2020年5月(54)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/04.html" class="category-item-link" rel="" target="">2020年4月(9)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/03.html" class="category-item-link" rel="" target="">2020年3月(40)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/02.html" class="category-item-link" rel="" target="">2020年2月(27)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2020/01.html" class="category-item-link" rel="" target="">2020年1月(55)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/12.html" class="category-item-link" rel="" target="">2019年12月(32)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/11.html" class="category-item-link" rel="" target="">2019年11月(33)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/10.html" class="category-item-link" rel="" target="">2019年10月(30)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/09.html" class="category-item-link" rel="" target="">2019年9月(17)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/08.html" class="category-item-link" rel="" target="">2019年8月(27)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/07.html" class="category-item-link" rel="" target="">2019年7月(8)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/06.html" class="category-item-link" rel="" target="">2019年6月(5)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/03.html" class="category-item-link" rel="" target="">2019年3月(25)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/02.html" class="category-item-link" rel="" target="">2019年2月(18)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2019/01.html" class="category-item-link" rel="" target="">2019年1月(24)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/12.html" class="category-item-link" rel="" target="">2018年12月(14)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/11.html" class="category-item-link" rel="" target="">2018年11月(5)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/10.html" class="category-item-link" rel="" target="">2018年10月(23)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/09.html" class="category-item-link" rel="" target="">2018年9月(9)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/08.html" class="category-item-link" rel="" target="">2018年8月(118)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archive/2018/07.html" class="category-item-link" rel="" target="">2018年7月(34)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2011/12.html" class="category-item-link" rel="" target="">2011年12月(2)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2011/06.html" class="category-item-link" rel="" target="">2011年6月(1)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2010/06.html" class="category-item-link" rel="" target="">2010年6月(1)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2010/05.html" class="category-item-link" rel="" target="">2010年5月(2)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2008/03.html" class="category-item-link" rel="" target="">2008年3月(1)</a>

            </li>
            <li data-category-list-item-visible="false" style="display: none">
                
<a href="https://www.cnblogs.com/springsnow/archive/2007/07.html" class="category-item-link" rel="" target="">2007年7月(1)</a>

            </li>
        <li><a href="javascript:void(0)" onclick="sideColumnManager.loadMore(this)">更多</a></li>
    </ul>
    <h3>
        
文章档案<span class="sidebar-category-item-count">
    (1)
</span>


    </h3>
    <ul>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.cnblogs.com/springsnow/archives/2010/05.html" class="category-item-link" rel="nofollow noopener noreferrer" target="">2010年5月(1)</a>

            </li>
        
    </ul>
    <h3>
        
工具网站


    </h3>
    <ul>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="http://regex.kingshang.com/" class="category-item-link" rel="nofollow noopener noreferrer" target="_blank">在线正则表达式测试工具</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="http://blog.csdn.net/" class="category-item-link" rel="nofollow noopener noreferrer" target="_blank">csdn博客</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="http://www.dxper.net/documents/" class="category-item-link" rel="nofollow noopener noreferrer" target="">DevExpress中文帮助文档</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.w3cschool.cn/" class="category-item-link" rel="nofollow noopener noreferrer" target="_blank">w3cschool.cn</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://www.runoob.com/" class="category-item-link" rel="nofollow noopener noreferrer" target="">菜鸟教程</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://deerchao.cn/tools/wegester/" class="category-item-link" rel="nofollow noopener noreferrer" target="">在线正则表达式测试器</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="http://www.w3school.com.cn/" class="category-item-link" rel="nofollow noopener noreferrer" target="">w3school在线教程(老)</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://gitee.com/yangbobin" class="category-item-link" rel="nofollow noopener noreferrer" target="">我的码云gitee</a>

            </li>
            <li data-category-list-item-visible="true" style="display: block">
                
<a href="https://github.com/BobinYang/" class="category-item-link" rel="nofollow noopener noreferrer" target="">我的GitHub（慢）</a>

            </li>
        
    </ul>
</div>

<!-- 最新评论 -->



<!-- 阅读排行榜 -->


<!-- 评论排行榜 -->


<!-- 推荐排行榜 -->
</div>
                    <script>loadBlogSideColumn();</script>

</div>
</div>
<div class="clear"></div>
<div id="footer">
<p id="footer">
	Powered by: 
	<br>
	
	<a href="https://www.cnblogs.com/" id="footer_site_link">博客园</a>
	<br>
	Copyright © 2022 springsnow
<br><span id="poweredby">Powered by .NET 6 on Kubernetes</span>

</p>


</div>
</div>



<div id="page_end_html">
<script language="javascript" type="text/javascript">
// 生成目录索引列表
// ref: http://www.cnblogs.com/wangqiguo/p/4355032.html
// modified by: zzq
function GenerateContentList()
{
    var mainContent = $('#cnblogs_post_body');
    var h1_list = $('#cnblogs_post_body h2');//如果你的章节标题不是h2,只需要将这里的h2换掉即可

    if(mainContent.length < 1)
        return;
 
    if(h1_list.length>0)
    {
        var content = '<a rel="nofollow noopener"  name="_labelTop"></a>';
        content += '<div id="navCategory" style="color:#152e97;">';
        content += '<p style="font-size:18px;"><b>目录</b></p>';
        content += '<ul>';
        for(var i=0; i<h1_list.length; i++)
        {
             //var go_to_top = '<div style="text-align: right;"><a rel="nofollow noopener"  href="#_labelTop" style="color:#f68a33">回到顶部</a><a rel="nofollow noopener"  name="_label' + i + '"></a></div>';
            var go_to_top = '<div style="text-align: right;"><a rel="nofollow noopener"  name="_label' + i + '"></a></div>';
            $(h1_list[i]).before(go_to_top);
            
            var h2_list = $(h1_list[i]).nextAll("h3");
            var li2_content = '';
            for(var j=0; j<h2_list.length; j++)
            {
                var tmp = $(h2_list[j]).prevAll('h2').first();
                if(!tmp.is(h1_list[i]))
                    break;
                var li2_anchor = '<a rel="nofollow noopener"  name="_label' + i + '_' + j + '"></a>';
                $(h2_list[j]).before(li2_anchor);


            var h3_list = $(h2_list[j]).nextAll("h4");
            var li3_content = '';
            for(var k=0; k<h3_list.length; k++)
            {
                var tmp = $(h3_list[k]).prevAll('h3').first();
                if(!tmp.is(h2_list[j]))
                    break;
                var li3_anchor = '<a rel="nofollow noopener"  name="_label' + i + '_' + j +  '_' + k + '"></a>';
                $(h3_list[k]).before(li3_anchor);
                li3_content += '<li><a rel="nofollow noopener"  href="#_label' + i + '_' + j +  '_' + k + '">' + $(h3_list[k]).text() + '</a></li>';
            }

		if(li3_content.length > 0)
                  li2_content += '<li><a rel="nofollow noopener"  href="#_label' + i + '_' + j + '">' + $(h2_list[j]).text() + '</a><ul>' + li3_content + '</ul></li>';
                else
                  li2_content += '<li><a rel="nofollow noopener"  href="#_label' + i + '_' + j + '">' + $(h2_list[j]).text() + '</a></li>';
            }
            
            var li1_content = '';
            if(li2_content.length > 0)
                li1_content = '<li><a rel="nofollow noopener"  href="#_label' + i + '">' + $(h1_list[i]).text() + '</a><ul>' + li2_content + '</ul></li>';
            else
                li1_content = '<li><a rel="nofollow noopener"  href="#_label' + i + '">' + $(h1_list[i]).text() + '</a></li>';
            content += li1_content;
        }
        content += '</ul>';
        content += '</div><p>&nbsp;</p>';
        content += '<hr style="height:1px;border:none;border-top:1px dashed #0066CC;"/>';
        if($('#cnblogs_post_body').length != 0 )
        {
            $($('#cnblogs_post_body')[0]).prepend(content);
        }
    }   
}

GenerateContentList();
</script>

<script>
function add() {
    var all_a =  document.getElementById("cnblogs_post_body") .getElementsByTagName("a");
    host_url=window.location.host;
    for (var i = 0; i < all_a.length; i++) {
        var domain = all_a[i].href.split("/"); //以“/”进行分割
        if (domain[2]!=host_url) {
                 all_a[i].target = "_blank";
        }
    }
}
    add();
</script> 
<link rel="stylesheet" href="./03_files/vs.min.css">
<script src="./03_files/highlight.min.js.下載"></script>
<script>
    hljs.registerLanguage('cshtml-razor', window.hljsDefineCshtmlRazor);
    hljs.initHighlightingOnLoad();
</script> 

<link rel="stylesheet" href="./03_files/codemirror.min.css" integrity="sha512-xIf9AdJauwKIVtrVRZ0i4nHP61Ogx9fSRAkCLecmE2dL/U8ioWpDvFCAy4dcfecN72HHB9+7FfQj3aiO68aaaw==" crossorigin="anonymous">
<script src="./03_files/codemirror.min.js.下載" integrity="sha512-UxcTlYsLkcuGZL9JNnMsfo3p7VFSmcgBjH1VUSM82Okk5ni52bk7vz9f2p+D1VnMcNUmMzbzgWqWcdJ2j8Svow==" crossorigin="anonymous"></script>

</div>

<input type="hidden" id="antiforgery_token" value="CfDJ8NfDHj8mnYFAmPyhfXwJojeIVx79SrBlgNbCGBh2P0zpHANYq2cA6rSwvfmZxo_Pl-fVMl43b6BR9316epq_72uEcHveORn0KHH4AZ66hJh78vkcGdpkUn6DjUbxJvsLBzzuYsDwK1E1EN14mzmTfFM">
<script async="" src="./03_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    var kv = getGACustom();
    if (kv) {
        gtag('set', kv);
    }
    gtag('config', 'UA-476124-1');
</script>
<script defer="" src="./03_files/hm.js.下載"></script><iframe src="./03_files/container.html" style="visibility: hidden; display: none;"></iframe>

<div class="uprightsideBar" id="uprightsideBar"><div id="sideBarTab"><h2>目录导航</h2></div><div id="sideBarContents" style="display: none;"><dl><dt name="0">一、介绍：</dt><dd name="1">1、安装Selenium：</dd><dt name="2">二、等待</dt><dd name="3">1、隐式等待：ImplicitlyWait</dd><dd name="4">2、显示等待：WebDriverWait()</dd><dt name="5">三、查找（定位对象）</dt><dt name="6">四、获取页面元素和元素内容</dt><dd name="7">1.Title：标题</dd><dd name="8">2.Url：链接</dd><dd name="9">3.Text：元素的文本值</dd><dd name="10">4.Selected勾选情况、TagName标记名标、Enabled编辑状态、Displayed显示状态</dd><dd name="11">5.GetAttribute（）获取标签的属性</dd><dd name="12">6.弹出对话框的处理</dd><dt name="13">五、操作元素对象WebElement</dt><dd name="14">1、模拟鼠标点击元素</dd><dd name="15">2、下拉列表框Select的操作</dd><dd name="16">2、执行JS</dd><dd name="17">3、页面导航</dd><dd name="18">4、拖拽操作(可以实现滑动验证码的验证)</dd><dd name="19">5、模拟鼠标晃动</dd><dd name="20">6、截图功能</dd><dd name="21">7、selenium操作滚轮滑动到底部</dd><dt name="22">六、获得窗口标识WindowHandles</dt><dd name="23">1、关闭多个子Browser窗口</dd><dd name="24">2、对iframe中元素的定位</dd><dt name="25">七、Cookies</dt><dt name="26">八、Window窗口控制</dt><dt name="27">九、事件</dt><dt name="28">十、关闭浏览器</dt></dl></div></div><iframe src="./03_files/aframe.html" width="0" height="0" style="display: none;"></iframe></body></html>